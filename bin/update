#!/usr/bin/env bash
set -o xtrace

function upgrade_brew() {
	echo "brew upgrade"
	brew outdated||\
		brew update&&\
		# TODO: don't ask to `brew upgrade` if there are no outdated packages
			read -p 'Would you like to upgrade Brew (y/n): ' upgradeBrew
			if [[ "$upgradeBrew" == "y" ]]; then
				brew upgrade
				echo "brew upgrade --cask"
				brew upgrade --cask
			fi
}

echo
function upgrade_neovim() {
	echo "neovim"

	# `Plug` is so fast at updating, let's not even ask
	nvim +PlugUpdate +qall
}


function upgrade_npm() {
	read -p 'Would you like to upgrade Node (y/n): ' upgradeNode
	if [[ "$upgradeNode" == "y" ]]; then
		npm outdated
		echo "npm update -g"
		npm install npm -g --force
		npm update -g

	fi
}

function upgrade_app_store() {
	echo "App Store"
	# open "macappstore://showUpdatesPage"
	mas outdated
	# TODO: Don't ask to upgrade apps if nothing is outdated
	read -p 'Would you like to upgrade apps?  (y/n): ' upgradeApps
	if [[ "$upgradeApps" == "y" ]]; then
		mas upgrade
	fi
	echo
}

function upgrade_macos() {
	echo "softwareupdate -l"
	softwareupdate -l
	# TODO: Don't ask to upgrade macOS if nothing is outdated
	read -p 'Would you like to upgrade macOS (y/n): ' upgradeMacOS
	if [[ "$upgradeMacOS" == "y" ]]; then
		softwareupdate -i -a --verbose
	fi
}

upgrade_brew
upgrade_neovim
upgrade_npm
upgrade_app_store
upgrade_macos


set +o xtrace

